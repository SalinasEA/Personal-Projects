{"ast":null,"code":"import { ChangeDetectorRef } from '@angular/core';\nimport { FormBuilder } from '@angular/forms';\nimport { Observable, map } from 'rxjs';\nimport { Country } from 'src/app/model/country';\nimport { Customer } from 'src/app/model/customer';\nimport { Division } from 'src/app/model/division';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nexport let EditCustomerComponent = /*#__PURE__*/(() => {\n  class EditCustomerComponent {\n    constructor(http, router, form, changeDetect) {\n      this.http = http;\n      this.router = router;\n      this.form = form;\n      this.changeDetect = changeDetect;\n      this.customerUrl = 'http://localhost:8080/api/customers';\n      this.countryUrl = 'http://localhost:8080/api/countries';\n      this.divisionUrl = 'http://localhost:8080/api/divisions';\n      this.countries = [];\n      this.divisions = [];\n      this.filteredDivisions = [];\n      this.customer = new Customer(0, '', '', '', '', '', 0, {});\n      this.countryChoice = new Country(0, '', {\n        self: {\n          href: ''\n        }\n      });\n      this.divisionChoice = new Division(0, '', 0, {\n        country: {\n          href: ''\n        },\n        self: {\n          href: ''\n        }\n      });\n    }\n\n    ngOnInit() {\n      // Parse customer Id\n      this.customer.id = parseInt(this.router.url.split(\"/\")[2]);\n      let url = this.customerUrl + \"/\" + this.customer.id; // Load dropdowns\n\n      this.getCountries().subscribe(countries => {\n        this.countries = countries;\n        this.getDivisions().subscribe(divisions => {\n          this.divisions = divisions; // Load customer\n\n          this.http.get(url).subscribe(customer => {\n            this.customer = customer; // Load division\n\n            url += \"/division\";\n            this.http.get(url).subscribe(division => {\n              this.customer.division_id = division.id; // Customer is fully loaded.\n\n              console.table(this.customer); // Select current values from dropdowns\n\n              this.filterDivisionsByCountry(division.country_id);\n              let country = this.getCountryById(division.country_id);\n              this.countryChoice = country;\n              this.divisionChoice = division;\n            });\n          });\n        });\n      });\n    }\n\n    ngAfterContentChecked() {\n      if (this.filteredDivisions.length > 0) {\n        this.form.control('place');\n      }\n    }\n\n    getCountries() {\n      return this.http.get(this.countryUrl).pipe(map(response => response._embedded.countries));\n    }\n\n    getDivisions() {\n      return this.http.get(this.divisionUrl).pipe(map(response => response._embedded.divisions));\n    }\n\n    getCountryById(id) {\n      return this.countries.find(country => {\n        return country.id == id;\n      }) ?? new Country(0, '', {\n        self: {\n          href: ''\n        }\n      });\n    }\n\n    filterDivisionsByCountry(selectedCountry) {\n      console.table(selectedCountry);\n      this.filteredDivisions = this.divisions.filter(division => {\n        return division.country_id == parseInt(selectedCountry);\n      });\n    }\n\n    onSubmit() {\n      let customer = {\n        firstName: this.customer.firstName,\n        lastName: this.customer.lastName,\n        address: this.customer.address,\n        postal_code: this.customer.postal_code,\n        phone: this.customer.phone,\n        division: this.divisionUrl + \"/\" + this.divisionChoice.id\n      }; // this.http.put(this.customerUrl + \"/\" + this.customer.id, customer).subscribe();\n\n      this.http.put(this.customerUrl + \"/\" + this.customer.id, customer).subscribe(response => {\n        console.log(\"Customer updated successfully:\", response);\n      }, error => {\n        console.error(\"Error updating customer:\", error);\n      });\n      this.router.navigate([\"/customer\"]).then(() => {\n        window.location.reload();\n      });\n    }\n\n  }\n\n  EditCustomerComponent.ɵfac = function EditCustomerComponent_Factory(t) {\n    return new (t || EditCustomerComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.FormBuilder), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n  };\n\n  EditCustomerComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EditCustomerComponent,\n    selectors: [[\"app-edit-customer\"]],\n    decls: 24,\n    vars: 5,\n    consts: [[1, \"form\", 3, \"ngSubmit\"], [1, \"input-container\"], [\"for\", \"firstName\"], [\"id\", \"firstName\", \"name\", \"firstName\", \"type\", \"text\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"lastName\"], [\"id\", \"lastName\", \"name\", \"lastName\", \"type\", \"text\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"address\"], [\"id\", \"address\", \"name\", \"address\", \"type\", \"text\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"postal_code\"], [\"id\", \"postal_code\", \"name\", \"postal_code\", \"type\", \"text\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"phone\"], [\"id\", \"phone\", \"name\", \"phone\", \"type\", \"text\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"submit\", 1, \"button-31\"]],\n    template: function EditCustomerComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"form\", 0);\n        i0.ɵɵlistener(\"ngSubmit\", function EditCustomerComponent_Template_form_ngSubmit_0_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\")(3, \"label\", 2);\n        i0.ɵɵtext(4, \" First Name \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"input\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function EditCustomerComponent_Template_input_ngModelChange_5_listener($event) {\n          return ctx.customer.firstName = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"div\")(7, \"label\", 4);\n        i0.ɵɵtext(8, \" Last Name \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"input\", 5);\n        i0.ɵɵlistener(\"ngModelChange\", function EditCustomerComponent_Template_input_ngModelChange_9_listener($event) {\n          return ctx.customer.lastName = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(10, \"div\")(11, \"label\", 6);\n        i0.ɵɵtext(12, \" Address \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"input\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function EditCustomerComponent_Template_input_ngModelChange_13_listener($event) {\n          return ctx.customer.address = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"div\")(15, \"label\", 8);\n        i0.ɵɵtext(16, \" Postal Code \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"input\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function EditCustomerComponent_Template_input_ngModelChange_17_listener($event) {\n          return ctx.customer.postal_code = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(18, \"div\")(19, \"label\", 10);\n        i0.ɵɵtext(20, \" Phone Number \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"input\", 11);\n        i0.ɵɵlistener(\"ngModelChange\", function EditCustomerComponent_Template_input_ngModelChange_21_listener($event) {\n          return ctx.customer.phone = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(22, \"button\", 12);\n        i0.ɵɵtext(23, \"Back\");\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.customer.firstName);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.customer.lastName);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.customer.address);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.customer.postal_code);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.customer.phone);\n      }\n    },\n    dependencies: [i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.NgModel, i3.NgForm],\n    styles: [\"body[_ngcontent-%COMP%]{align-items:center;background-color:#000;display:flex;justify-content:center;height:100vh}.form[_ngcontent-%COMP%]{border-radius:20px;box-sizing:border-box;padding:20px;min-width:320px}.title[_ngcontent-%COMP%]{color:#eee;font-family:sans-serif;font-size:36px;font-weight:600;margin-top:30px}.subtitle[_ngcontent-%COMP%]{color:#eee;font-family:sans-serif;font-size:16px;font-weight:600;margin-top:10px}.ic1[_ngcontent-%COMP%]{margin-top:40px}.ic2[_ngcontent-%COMP%]{margin-top:30px}.input[_ngcontent-%COMP%]{border-radius:12px;border:0;box-sizing:border-box;color:#eee;font-size:18px;height:100%;outline:0;padding:4px 20px 0;width:100%}.cut[_ngcontent-%COMP%]{background-color:#15172b;border-radius:10px;height:20px;left:20px;position:absolute;top:-20px;transform:translateY(0);transition:transform .2s;width:76px}.cut-short[_ngcontent-%COMP%]{width:50px}.input[_ngcontent-%COMP%]:focus ~ .cut[_ngcontent-%COMP%], .input[_ngcontent-%COMP%]:not(:placeholder-shown) ~ .cut[_ngcontent-%COMP%]{transform:translateY(8px)}.placeholder[_ngcontent-%COMP%]{color:#65657b;font-family:sans-serif;left:20px;line-height:14px;pointer-events:none;position:absolute;transform-origin:0 50%;transition:transform .2s,color .2s;top:20px}.input[_ngcontent-%COMP%]:focus ~ .placeholder[_ngcontent-%COMP%], .input[_ngcontent-%COMP%]:not(:placeholder-shown) ~ .placeholder[_ngcontent-%COMP%]{transform:translateY(-30px) translate(10px) scale(.75)}.input[_ngcontent-%COMP%]:not(:placeholder-shown) ~ .placeholder[_ngcontent-%COMP%]{color:#808097}.input[_ngcontent-%COMP%]:focus ~ .placeholder[_ngcontent-%COMP%]{color:#dc2f55}.submit[_ngcontent-%COMP%]{border-radius:12px;border:0;box-sizing:border-box;color:#eee;cursor:pointer;font-size:18px;height:50px;margin-top:38px;outline:0;text-align:center;width:100%}.submit[_ngcontent-%COMP%]:active{background-color:#06b}input[type=text][_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:12px 20px;margin:8px 0 20px;display:inline-block;border:1px solid #ccc;border-radius:4px;box-sizing:border-box}.button-31[_ngcontent-%COMP%]{background-color:#222;border-radius:4px;border-style:none;box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;font-family:Farfetch Basis,Helvetica Neue,Arial,sans-serif;font-size:16px;font-weight:700;line-height:1.5;margin:0;max-width:none;min-height:44px;outline:none;overflow:hidden;padding:9px 20px 8px;position:relative;text-align:center;text-transform:none;user-select:none;-webkit-user-select:none;touch-action:manipulation}.button-31[_ngcontent-%COMP%]:hover, .button-31[_ngcontent-%COMP%]:focus{opacity:.75}\"]\n  });\n  return EditCustomerComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}