{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../../services/purchase-data.service\";\nimport * as i4 from \"@angular/common\";\n\nfunction CartComponent_ul_7_li_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const excursion_r4 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(excursion_r4.excursion_title);\n  }\n}\n\nfunction CartComponent_ul_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\", 7)(1, \"li\")(2, \"h2\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"ul\");\n    i0.ɵɵtemplate(5, CartComponent_ul_7_li_5_Template, 2, 1, \"li\", 8);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const vacation_r2 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(vacation_r2.vacation_title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", vacation_r2.excursions);\n  }\n}\n\nconst _c0 = function () {\n  return [\"/cart-summary\"];\n};\n/**\r\n * Cart\r\n * Display cart on pages\r\n *\r\n *\r\n */\n\n\nexport let CartComponent = /*#__PURE__*/(() => {\n  class CartComponent {\n    constructor(http, route, purchaseDataService) {\n      this.http = http;\n      this.route = route;\n      this.purchaseDataService = purchaseDataService;\n      this.cartsUrl = \"http://localhost:8080/api/carts\";\n      this.cartItemsUrl = \"\";\n      this.customerUrl = \"http://localhost:8080/api/customers/1\";\n      this.cartId = 0;\n      this.cartItems = [];\n      this.vacations = new Set();\n      this.package_price = 0;\n      this.party_size = 1;\n      this.cartItemsPrice = 0;\n    }\n\n    ngOnInit() {\n      // load data service\n      this.purchaseDataService.purchaseServiceData.subscribe(serviceData => {\n        console.log('Excursion Detail Current Data Service:', serviceData);\n        this.purchaseServiceDto = serviceData;\n      }); // get the current party size\n\n      this.party_size = this.purchaseServiceDto.getCart().getPartySize();\n      console.log(\"PARTY SIZE 1 \" + this.party_size); // call sum with string\n\n      this.sumCartItems(this.party_size.toString());\n    }\n    /**\r\n     * process party size and price\r\n     * call on init and when party size changes on page\r\n     *\r\n     * @param party_size\r\n     */\n\n\n    sumCartItems(party_size) {\n      this.party_size = parseInt(party_size);\n      console.log(\"PARTY SIZE 2 \" + this.party_size);\n      this.purchaseServiceDto.getCart().setPartySize(this.party_size); // reset price for new calc\n\n      this.cartItemsPrice = 0;\n      let cartItemList = this.purchaseServiceDto.getCartItems();\n      cartItemList.forEach(currentCartItem => {\n        // get vacation price\n        let vacationPrice = currentCartItem.getVacation().getTravelPrice(); // add vacation cost\n\n        this.cartItemsPrice += vacationPrice;\n        console.log(this.cartItemsPrice); // get excursion prices\n\n        let excursionList = currentCartItem.getExcursions(); // loop through excursion and add price\n\n        excursionList.forEach(currentExcursion => {\n          let excursionPrice = currentExcursion.getExcursionPrice();\n          this.cartItemsPrice += excursionPrice;\n          console.log(\"Prices when add Excursions \" + this.cartItemsPrice);\n        }); // calculate total package price\n\n        this.package_price = this.cartItemsPrice * this.party_size;\n        console.log(\"PACKAGE PRICE IN SUM \" + this.package_price);\n      }); // update the data service with new package price and party size\n\n      this.purchaseServiceDto.getCart().setPackagePrice(this.package_price);\n      this.purchaseServiceDto.getCart().setPartySize(this.party_size);\n    }\n\n  }\n\n  CartComponent.ɵfac = function CartComponent_Factory(t) {\n    return new (t || CartComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.PurchaseDataService));\n  };\n\n  CartComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CartComponent,\n    selectors: [[\"app-cart\"]],\n    decls: 17,\n    vars: 8,\n    consts: [[1, \"content\"], [\"for\", \"party_size\"], [\"type\", \"number\", \"max\", \"20\", \"min\", \"1\", \"id\", \"party_size\", \"name\", \"party_size\", 3, \"value\", \"input\"], [\"psi\", \"\"], [\"id\", \"cart-items\", 4, \"ngFor\", \"ngForOf\"], [1, \"button-and-total-container\"], [1, \"button-31\", 3, \"routerLink\"], [\"id\", \"cart-items\"], [4, \"ngFor\", \"ngForOf\"]],\n    template: function CartComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r5 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"h2\");\n        i0.ɵɵtext(1, \"Cart\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"div\", 0)(3, \"label\", 1);\n        i0.ɵɵtext(4, \"Party Size:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"input\", 2, 3);\n        i0.ɵɵlistener(\"input\", function CartComponent_Template_input_input_5_listener() {\n          i0.ɵɵrestoreView(_r5);\n\n          const _r0 = i0.ɵɵreference(6);\n\n          return i0.ɵɵresetView(ctx.sumCartItems(_r0.value));\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(7, CartComponent_ul_7_Template, 6, 2, \"ul\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 5)(9, \"p\");\n        i0.ɵɵtext(10, \"Bag Total: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"p\");\n        i0.ɵɵtext(12);\n        i0.ɵɵpipe(13, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"button\", 6)(15, \"a\");\n        i0.ɵɵtext(16, \"Checkout\");\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵpropertyInterpolate(\"value\", ctx.party_size);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.vacations);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate1(\"$\", i0.ɵɵpipeBind2(13, 4, ctx.package_price, \"1.2-2\"), \"\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(7, _c0));\n      }\n    },\n    dependencies: [i4.NgForOf, i2.RouterLink, i4.DecimalPipe],\n    styles: [\".content[_ngcontent-%COMP%]{position:relative;top:0;bottom:0;height:100%}h2[_ngcontent-%COMP%]{font-size:1.3rem}li[_ngcontent-%COMP%]{font-size:1rem;margin-left:0;margin-top:25px;text-align:left}#cart-items[_ngcontent-%COMP%]{list-style:none;padding-left:30px}.button-and-total-container[_ngcontent-%COMP%]{position:relative;bottom:0;left:0;right:0;margin-bottom:40px;align-items:center}.button-31[_ngcontent-%COMP%]{background-color:#222;border-radius:4px;border-style:none;box-sizing:border-box;color:#fff;cursor:pointer;display:inline-block;font-family:Farfetch Basis,Helvetica Neue,Arial,sans-serif;font-size:16px;font-weight:700;line-height:1.5;margin:0;max-width:none;min-height:44px;min-width:10px;outline:none;overflow:hidden;padding:9px 20px 8px;text-align:center;text-transform:none;user-select:none;-webkit-user-select:none;touch-action:manipulation;width:60%;position:relative;bottom:0}.button-31[_ngcontent-%COMP%]:hover, .button-31[_ngcontent-%COMP%]:focus{opacity:.75}.cart[_ngcontent-%COMP%]{float:right;right:0;margin:16px;width:400px;border-left:none;background:white;color:#000;border-radius:10px;padding:16px;text-align:center;z-index:0}#party_size[_ngcontent-%COMP%]{width:30px;height:30px;margin-left:10px;font-size:20px;padding:0 0 0 13px;border:2px solid black}\"]\n  });\n  return CartComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}