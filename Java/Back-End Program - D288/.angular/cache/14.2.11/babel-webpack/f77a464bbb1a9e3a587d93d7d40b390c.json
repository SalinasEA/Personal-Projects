{"ast":null,"code":"import { map } from 'rxjs/operators';\nimport { Customer } from \"../../model/customer\";\nimport { CartDto } from \"../../model/dto/cart-dto.model\";\nimport { StatusType } from \"../../model/StatusType\";\nimport { CustomerDto } from \"../../model/dto/customer-dto\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../../services/purchase-data.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/material/button\";\nimport * as i6 from \"@angular/material/icon\";\nimport * as i7 from \"@angular/material/card\";\nimport * as i8 from \"@angular/flex-layout/flex\";\nimport * as i9 from \"../cart/cart.component\";\n\nconst _c0 = function (a1) {\n  return [\"/vacation-detail\", a1];\n};\n\nfunction VacationComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6)(1, \"mat-card\", 7);\n    i0.ɵɵelement(2, \"img\", 8);\n    i0.ɵɵelementStart(3, \"mat-card-header\")(4, \"mat-card-title\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"mat-card-content\")(7, \"p\", 9);\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"number\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"mat-card-actions\")(11, \"button\", 10)(12, \"mat-icon\", 11);\n    i0.ɵɵtext(13, \"shopping_cart\");\n    i0.ɵɵelementEnd()()()()();\n  }\n\n  if (rf & 2) {\n    const vacation_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"src\", vacation_r1.image_URL, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(vacation_r1.vacation_title);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" $\", i0.ɵɵpipeBind2(9, 4, vacation_r1.travel_price, \"1.2-2\"), \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(7, _c0, vacation_r1.id));\n  }\n}\n/**\r\n *\r\n */\n\n\nexport let VacationComponent = /*#__PURE__*/(() => {\n  class VacationComponent {\n    constructor(http, purchaseDataService) {\n      this.http = http;\n      this.purchaseDataService = purchaseDataService; // urls\n\n      this.vacationUrl = 'http://localhost:8080/api/vacations';\n      this.cartsUrl = 'http://localhost:8080/api/carts';\n      this.customerUrl = \"http://localhost:8080/api/customers\"; // vacations for the page\n\n      this.vacations = []; // customer\n\n      this.customer = new Customer(0, \"\", \"\", \"\", \"\", \"\", 0);\n      this.status = StatusType.pending;\n      this.customerDto = new CustomerDto(0, \"\", \"\", \"\", \"\", \"\");\n      this.cartDto = new CartDto(0, 0, 0, this.status, this.customerDto);\n      this.allCarts = [];\n      this.newCartDto = new CartDto(0, 0, 0, this.status, this.customerDto);\n      this.customers = [];\n      this.newestCustomerInDB = 0;\n      this.lastCartId = 0;\n    }\n\n    ngOnInit() {\n      // purchase data service\n      this.purchaseDataService.purchaseServiceData.subscribe(serviceData => {\n        // console.log('Excursion Detail Current Data Service:', serviceData);\n        this.purchaseServiceDto = serviceData;\n      }); // get the ID of the newest customer in the database\n\n      this.getCustomers().subscribe(customers => {\n        this.customers = customers;\n        console.log(\"CUSTOMER LENGTH \" + this.customers.length);\n        this.newestCustomerInDB = this.customers[customers.length - 1].id;\n        console.log(\"LAST CUSTOMER \" + this.newestCustomerInDB.toString());\n        this.getCustomer(this.newestCustomerInDB).subscribe(customer => {\n          this.customer = customer;\n          console.log(\"LAST CUSTOMER IN DB \" + this.customer);\n        });\n      });\n      this.getVacations().subscribe(vacations => {\n        vacations.forEach(vacation => {\n          let parsedId = vacation._links.self.href.split(\"/\")[5];\n\n          vacation.id = parseInt(parsedId);\n        });\n        this.vacations = vacations;\n      });\n    } // end on init\n\n\n    ngOnDestroy() {\n      // set customer details\n      this.purchaseServiceDto.getCustomer().setId(this.customer.id);\n      this.purchaseServiceDto.getCustomer().setFirstName(this.customer.firstName);\n      this.purchaseServiceDto.getCustomer().setLastName(this.customer.lastName);\n      this.purchaseServiceDto.getCustomer().setAddress(this.customer.address);\n      this.purchaseServiceDto.getCustomer().setPostalCode(this.customer.postal_code);\n      this.purchaseServiceDto.getCustomer().setPhone(this.customer.phone); // set cart status\n\n      this.purchaseServiceDto.getCart().setStatusType(StatusType.pending);\n    }\n\n    getCustomer(idIn) {\n      console.log(\"CUSTOMER ID PASSED TO GET CUSTOMER \" + idIn);\n      return this.http.get(this.customerUrl + \"/\" + idIn);\n    }\n\n    getCustomers() {\n      return this.http.get(this.customerUrl).pipe(map(response => response._embedded.customers));\n    }\n\n    getAllCustomers() {\n      return this.http.get(this.customerUrl);\n    }\n\n    getVacations() {\n      return this.http.get(this.vacationUrl).pipe(map(response => response._embedded.vacations));\n    }\n\n  }\n\n  VacationComponent.ɵfac = function VacationComponent_Factory(t) {\n    return new (t || VacationComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.PurchaseDataService));\n  };\n\n  VacationComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: VacationComponent,\n    selectors: [[\"app-vacation\"]],\n    decls: 7,\n    vars: 1,\n    consts: [[1, \"content\"], [\"fxLayout\", \"row wrap\", \"fxLayoutGap\", \"16px grid\", 1, \"grid\"], [\"fxFlex\", \"25%\", \"fxFlex.xs\", \"100%\", \"fxFlex.sm\", \"33%\", 4, \"ngFor\", \"ngForOf\"], [1, \"cart-container\"], [1, \"vl\"], [1, \"cart\"], [\"fxFlex\", \"25%\", \"fxFlex.xs\", \"100%\", \"fxFlex.sm\", \"33%\"], [1, \"mat-elevation-z4\"], [\"mat-card-image\", \"\", 1, \"vacation-card-image\", 3, \"src\"], [1, \"price\"], [\"mat-button\", \"\", 1, \"menu-button\", 3, \"routerLink\"], [1, \"icon-display\"]],\n    template: function VacationComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵtemplate(2, VacationComponent_div_2_Template, 14, 9, \"div\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelement(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"div\", 5);\n        i0.ɵɵelement(6, \"app-cart\");\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.vacations);\n      }\n    },\n    dependencies: [i3.NgForOf, i4.RouterLink, i5.MatButton, i6.MatIcon, i7.MatCard, i7.MatCardHeader, i7.MatCardContent, i7.MatCardTitle, i7.MatCardActions, i7.MatCardImage, i8.DefaultLayoutDirective, i8.DefaultLayoutGapDirective, i8.DefaultFlexDirective, i9.CartComponent, i3.DecimalPipe],\n    styles: [\".content[_ngcontent-%COMP%]{display:block;margin-top:25px;margin-left:auto;margin-right:auto;padding:25px}.vacation-card-image[_ngcontent-%COMP%]{width:100%;height:300px;display:block;margin-left:0;margin-right:0;padding-left:0;padding-right:0}.vacation-card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.mat-card[_ngcontent-%COMP%]{padding:0;margin-bottom:20px}.mat-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding-left:16px;padding-right:16px}.price[_ngcontent-%COMP%]{font-size:1.3rem}.menu-button[_ngcontent-%COMP%]{position:absolute;bottom:18px;right:25px;transform:scale(1.5);width:0px}.grid[_ngcontent-%COMP%]{float:left;width:80%}.cart-container[_ngcontent-%COMP%]{float:right;width:20%}.cart[_ngcontent-%COMP%]{background:white;color:#000;border-radius:10px;text-align:center;padding:16px 16px 16px 0;margin:16px 16px 16px 0;box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f}\"]\n  });\n  return VacationComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}